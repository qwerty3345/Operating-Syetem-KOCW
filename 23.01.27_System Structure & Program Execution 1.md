## ✅ 1/27 - System Structure & Program Execution 1

- CPU 의 작업 공간은 메모리
    - 매 클럭마다 인스트럭션을 메모리에서 읽어서 실행하는 역할을 함
- 각 I/O 디바이스에 붙어있는 디바이스 컨트롤러가 제어역할을 해 줌. (CPU의 역할)
- CPU에 비해 로컬 디바이스의 속도는 백만배 정도 느림
- 부팅 시 OS가 먼저 메모리에 상주하며 실행이 필요한 프로그램에게 CPU 를 넘겨주는 방식
![스크린샷 2023-01-27 오후 5 54 36 크게](https://user-images.githubusercontent.com/59835351/215061777-be95c9a1-47b9-44ca-8030-2e8669357926.jpeg)


### Register

- 명령어를 실행하기 위해 필요한 데이터와 상태, 명령어를 저장하는 곳.
- 메모리보다 더 빠르면서 정보를 저장할 수 있는데 용량이 작다

### Device Controller

- 각 I/O 디바이스마다 붙어있는 일종의 작은 CPU
- 자기 자신의 (I/O디바이스의) 로컬 버퍼만 접근이 가능함

### Local Buffer

- Device controller의 작업 공간 (작은 메모리)
- 메모리는 CPU 만 접근이 가능하고, IO 디바이스들은 각자의 로컬 버퍼에 접근해서 메모리처럼 쓰게끔 한 것

### DMA Controller

- I/O 장치의 입출력으로 인해 매번 CPU 의 인터럽트가 걸린다면 오버헤드가 너무 큼…
    - 그렇기에 메모리에 직접 접근할 수 있는 DMA 컨트롤러 (Direct Memory Access) 가 
    각 I/O 디바이스의 로컬 버퍼에서 데이터를 읽어서 메모리로 복사 해 주기도 함
    - 그 역할을 한 번에 해준 뒤, CPU 에 한 번에 인터럽트만 걸어서 알려주는 방식으로 동작

### Mode bit

- 지금 CPU 를 사용하는 주체가 운영체제인지 사용자 프로그램인지 정보를 관리
- OS가 사용하고 있을 때 : Mode Bit이 0
    - 대부분의 인스트럭션을 수행할 수 있음 (특권 명령)
- 사용자 프로그램이 사용하고 있을 때 : Mode Bit이 1
    - 위험한 액션을 수행 할 수 있기에 제한된 액션만 수행이 가능함.
- 보안을 위해 반드시 필요

### Timer

- 정해진 시간이 흐른 뒤 운영체제에게 제어권이 넘어가도록 인터럽트를 발생시킴
    - 타이머가 0이 될 때…
- CPU 를 특정 프로그램이 독점하는 것으로부터 보호함
- time sharing (시분할) 을 구현하기 위해 널리 이용됨
    - 또한 현재 시간을 계산하기 위해서도 이용

### 입출력 (I/O)의 수행

- 모든 입출력 명령은 특권명령 (OS 가 수행, Mode bit이 0)
- 사용자 프로그램이 I/O를 하는 법
    - 시스템 콜 → 사용자 프로그램이 운영체제에게 I/O를 요청함

### Interrupt

- 일반적으로 하드웨어가 거는 인터럽트를 칭함.
    - 소프트웨어의 인터럽트는 Trap 이라고 함 (ex. Exception, System Call)
- 현대의 운영체제는 “인터럽트”에 의해 구동됨
    - 인터럽트 당한 시점의 레지스터와 프로그램 카운터를 저장한 후, CPU 의 제어를 인터럽트 처리 루틴에 넘김
- 특정 프로그램이 CPU 를 독점하지 않게 하게 하기 위해 타이머를 사용해 인터럽트를 하기도 하고,
- 어떤 입력이 들어왔다는 것을 알려주기 위해 I/O 컨트롤러가 인터럽트를 걸기도 함
- 인터럽트가 들어 올 때만 CPU가 운영체제로 넘어가는 것
- 인터럽트 벡터: 해당 인터럽트의 처리 루틴 주소를 가지고 있음
- 인터럽트 처리 루틴: (= 인터럽트 핸들러) 해당 인터럽트를 처리하는 커널 함수

### System Call

- 사용자 프로그램이 운영체제의 서비스를 받기 위해 커널 함수를 호출하는 것
![스크린샷 2023-01-27 오후 7 09 29 크게](https://user-images.githubusercontent.com/59835351/215061798-4d9790b4-32a9-4559-9929-24a0b5a2f8ba.jpeg)
